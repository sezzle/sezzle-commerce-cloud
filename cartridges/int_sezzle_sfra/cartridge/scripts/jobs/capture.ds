'use strict';

var Status = require('dw/system/Status');
var sezzleService =  require('dw/svc').ServiceRegistry;

function execute(args) {
	try {
 		var result = sezzleService.get('sezzle.capture').call();  
		if (result.status == 'SERVICE_UNAVAILABLE') {
			return new Status(Status.ERROR);
		}
		require('int_sezzle_sfra/cartridge/scripts/sezzle.ds').order.captureOrders();
		return new Status(Status.OK);
	} catch (e) {
		return new Status(Status.ERROR);
	}
}

exports.execute = execute;